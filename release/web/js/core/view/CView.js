var ComView=mview.ComView,CView=function(){function t(t){this._parent=null,this._class=null,this._atlas_url=null,this._view_path=null,this._is_show=!1,this._is_need_show=!1,this._is_on_parent=!1,this._is_load_complete=!1,this._event_manager=EventManager.ins,this._vm=t}return t.prototype.regist=function(t,e){this._event_manager.on(t,e,this)},t.prototype.setAtlasName=function(t){this._atlas_url=t},t.prototype.setViewPath=function(t){this._view_path=t},t.prototype.setParent=function(t){this._parent=t},Object.defineProperty(t.prototype,"vm",{get:function(){return this._vm||CFun.throw("CView中_vm还未初始化！"),this._vm},enumerable:!0,configurable:!0}),t.prototype.setClass=function(t){this._class=t},t.prototype.onLoaded=function(){this._is_load_complete=!0,this._class||CFun.throw("VisibleView的_class为空！"),this._display=new this._class(this.vm),null==this._parent&&(this.display.viewType==ComView.WINDOW?this._parent=Layer.WINDOW_LAYER:this.display.viewType==ComView.TOP?this._parent=Layer.TOP_LAYER:(this.display.viewType,ComView.SCENE,this._parent=Layer.SCENE_LAYER)),this._is_need_show&&this.showNow()},t.prototype.onLoadResource=function(){this._atlas_url||CFun.throw("VisibleView的_atlas_url为空！");for(var t=[],e=this._atlas_url.split(","),i=e.length,s=0;s<i;s++)""!=e[s]&&t.push({url:e[s],type:laya.net.Loader.ATLAS});for(var o=this._view_path.split(","),s=0;s<i;s++)""!=o[s]&&t.push({url:o[s]+".json",type:laya.net.Loader.JSON});t.length>0&&Laya.loader.load(t,laya.utils.Handler.create(this,this.onLoaded))},t.prototype.addToParent=function(){this._parent||CFun.throw("VisibleView的addToParent中的_parent为空！"),this._parent.addChild(this.display),Layer.WINDOW_LAYER==this._parent&&(Layer.WINDOW_LAYER.mouseEnabled=!0),Layer.TOP_LAYER==this._parent&&(Layer.TOP_LAYER.mouseEnabled=!0),this._is_on_parent=!0},t.prototype.removeFromParent=function(){this._parent||CFun.throw("VisibleView的removeFromParent中的_parent为空！"),this._parent.removeChild(this.display),this._parent.numChildren<=0&&(Layer.WINDOW_LAYER==this._parent&&(Layer.WINDOW_LAYER.mouseEnabled=!1),Layer.TOP_LAYER==this._parent&&(Layer.TOP_LAYER.mouseEnabled=!1)),this._is_on_parent=!1,this._is_show=!1},Object.defineProperty(t.prototype,"display",{get:function(){return this._display||CFun.throw("VisibleView的_display为空！"),this._display},enumerable:!0,configurable:!0}),t.prototype.showNow=function(){this.vm.preShow(),this._is_need_show=!1,this.addToParent(),this.setVisible(!0),this.vm.afterShow()},t.prototype.closeNow=function(){this.vm.preClose(),this.removeFromParent(),this.setVisible(!1),this.vm.afterClose()},t.prototype.isOnParent=function(){return this._is_on_parent},t.prototype.isShow=function(){return this._is_show},t.prototype.closeME=function(){this._is_load_complete&&this.closeNow()},t.prototype.showME=function(){this._is_need_show||(this._is_need_show=!0,this._is_load_complete?this.showNow():this.onLoadResource())},t.prototype.setVisible=function(t){this.display.visible=t,this.isOnParent()&&(this._is_show=t)},t}();
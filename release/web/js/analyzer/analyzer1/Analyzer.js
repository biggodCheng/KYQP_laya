var Analyzer=function(){function t(){this.GENIUS_NUMBER=84048153,this.MAX_LEN=65535,this.BAD_LEN=16776960,this.INT_SIZE=4,this._packetLen=0,this._byte=new laya.utils.Byte,this._byte.endian=laya.utils.Byte.LITTLE_ENDIAN,this._byte.pos=0,new RpcDef,new RpcType}return t.prototype.analyzeRecv=function(t){this._byte.writeArrayBuffer(t);var e=this._packetLen;if(0==e&&(this._byte.pos=0,this._byte.bytesAvailable>=this.INT_SIZE)){StaticData.seed>0&&(void 0==this._encrypter&&(this._encrypter=new Ctx(StaticData.seed^this.GENIUS_NUMBER),this._decrypter=new Ctx(StaticData.seed^this.GENIUS_NUMBER)),this._decrypter.encode(this._byte,this.INT_SIZE,this._byte.pos));var i=(e=this._byte.getUint32())>>24&255;if(0==(e&=16777215)||e>this.BAD_LEN||i!=e%255)return CFun.throw("Invalid packet size: "+e),null;if(e>this.MAX_LEN)return CFun.throw("packet size exceed: "+e),null;this._packetLen=e}if(e>0&&this._byte.bytesAvailable>=e){this._packetLen=0,StaticData.seed>0&&(void 0==this._encrypter&&(this._encrypter=new Ctx(StaticData.seed^this.GENIUS_NUMBER),this._decrypter=new Ctx(StaticData.seed^this.GENIUS_NUMBER)),this._decrypter.encode(this._byte,e,this._byte.pos));for(var a=this._byte.getUint32(),s=RpcDef.getMethodByID(a),r={e_id:s.isStatic?0:this._byte.getUint32()+4294967296*this._byte.getInt16()},n=s.isStatic?"ModelHandle":s.className,y=s.args,h=y.length,_=void 0,l=void 0,c=0;c<h;c++){l=(_=y[c]).name;var o=RpcDef.getTypeReader(_.type);r[l]=o(this._byte)}var p=new ClassPro;return p.recv_id=s.id,p.className=n,p.event_id=s.server+"_"+s.className+"_"+s.name,p.params=r,this._byte.clear(),this._byte.pos=0,p}return null},t.prototype.analyzeSend=function(t){var e=laya.utils.Pool.getItemByClass("tmpByte",laya.utils.Byte);e.endian=laya.utils.Byte.LITTLE_ENDIAN,e.clear(),e.pos=0;var i=t.method;i||CFun.throw("RPC method not found: "+i.id),RpcType.uintWriter(e,i.id),i.isStatic||RpcType.int48Writer(e,t.e_id);for(var a,s=i.args,r=s.length,n=0;n<r;n++){a=s[n];var y=RpcDef.getTypeWriter(a.type);null==y&&CFun.throw("Type writer not found: "+a.type),y(e,t.args[n])}var h=e.length;if(h){h>this.BAD_LEN&&CFun.throw("Invalid packet size: "+h);var _=laya.utils.Pool.getItemByClass("tmpByte",laya.utils.Byte);_.endian=laya.utils.Byte.LITTLE_ENDIAN,_.clear(),_.pos=0;var l=h%255<<24|h;return _.length=h+this.INT_SIZE,_.writeUint32(l),_.writeArrayBuffer(e.buffer),StaticData.seed>0&&(void 0==this._encrypter&&(this._encrypter=new Ctx(StaticData.seed^this.GENIUS_NUMBER),this._decrypter=new Ctx(StaticData.seed^this.GENIUS_NUMBER)),this._encrypter.encode(_,_.length)),CFun.log(t.toString()),laya.utils.Pool.recover("tmpSend",t),laya.utils.Pool.recover("tmpByte",e),[_,_.buffer]}},t.seed=0,t}();
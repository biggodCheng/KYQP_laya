var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function a(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}();define(["require","exports","../CardLogic","./DZPKCardType"],function(t,e,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var r=t.call(this)||this;return e._instance&&CFun.throw("单例！"),r}return __extends(e,t),e.prototype.TogetherCardList=function(t,e){return CFun.remove(t,0),CFun.remove(e,0),e.concat(t)},e.prototype.getDZPKCardType=function(t,e){return 0==t.length?a.DZPKCardType.ERROR:this.findBigStraightLine(t,e).length>0?a.DZPKCardType.BIGSTRAIGHTLINE:this.findStraightLine(t,e).length>0?a.DZPKCardType.STRAIGHTLINE:this.findFour(t,e).length>0?a.DZPKCardType.FOUR:this.findFullHouse(t,e).length>0?a.DZPKCardType.FullHouse:this.findStraight(t,e).length>0?a.DZPKCardType.STRAIGHT:this.findLine(t,e).length>0?a.DZPKCardType.LINE:this.findThree(t,e).length>0?a.DZPKCardType.THREE:this.findTwo(t,e).length>1?a.DZPKCardType.TWODOUBLE:this.findTwo(t,e).length>0?a.DZPKCardType.DOUBLE:a.DZPKCardType.SINGLE},e.prototype.getCardTypeCards=function(t,e){if(0==t.length)return{cards:[],cardType:a.DZPKCardType.ERROR};var r=this.findBigStraightLine(t,e);return r.length>0?{cards:r[0],cardType:a.DZPKCardType.BIGSTRAIGHTLINE}:(r=this.findStraightLine(t,e)).length>0?{cards:r[0],cardType:a.DZPKCardType.STRAIGHTLINE}:(r=this.findFour(t,e)).length>0?{cards:r[0],cardType:a.DZPKCardType.FOUR}:(r=this.findFullHouse(t,e)).length>0?{cards:r[0],myCardList:t,publicCardList:e,cardType:a.DZPKCardType.FullHouse}:(r=this.findStraight(t,e)).length>0?(r[0].length=5,{cards:r[0],cardType:a.DZPKCardType.STRAIGHT}):(r=this.findLine(t,e)).length>0?{cards:r[0],cardType:a.DZPKCardType.LINE}:(r=this.findThree(t,e)).length>0?{cards:r[0],cardType:a.DZPKCardType.THREE}:(r=this.findTwo(t,e)).length>1?r.length>2?(r=this.getMaxTwoPair(r),{cards:r[0].concat(r[1]),cardType:a.DZPKCardType.TWODOUBLE}):{cards:r[0].concat(r[1]),cardType:a.DZPKCardType.TWODOUBLE}:(r=this.findTwo(t,e)).length>0?{cards:r[0],cardType:a.DZPKCardType.DOUBLE}:{cards:[],cardType:a.DZPKCardType.SINGLE}},e.prototype.findLine=function(t,e,r){void 0===r&&(r=5);var a=[],i=this.TogetherCardList(t,e);this.SortByCardData(i);for(var n=[],h=0;h<i.length;h++){n.push(i[h]);for(d=h+1;d<i.length;d++)if((1==this.getCardValue(i[h])?14:this.getCardValue(i[h]))-this.getCardValue(i[d])==n.length&&this.getCardValue(i[h])!=this.getCardValue(i[d])&&(n.push(i[d]),n.length==r)){a.push(n);break}if(1==this.getCardValue(i[h])){(n=[]).push(i[h]);for(var d=h+1;d<i.length;d++){if(1-this.getCardValue(i[d])==n.length-r&&this.getCardValue(i[h])!=this.getCardValue(i[d])&&(n.push(i[d]),n.length==r)){a.push(n);break}}}n=[]}if(a.length>1&&1==this.getCardValue(a[0][0])&&2==this.getCardValue(a[0][4])){var s=a[0];CFun.remove(a,a[0]),a.push(s)}return a},e.prototype.findStraightLine=function(t,e,r){void 0===r&&(r=5);var a=this.findStraight(t,e);return this.findLine(a.length>0?a[0]:[],[],r)},e.prototype.findBigStraightLine=function(t,e,r){void 0===r&&(r=5);for(var a=[],i=this.findStraightLine(t,e,r),n=0;n<i.length;n++)0!=this.getCardByValue(i[n],this.getCardValue(13))&&0!=this.getCardByValue(i[n],this.getCardValue(12))&&a.push(i[n]);return a},e.prototype.findStraight=function(t,e){var r=[],a=this.TogetherCardList(t,e);this.SortByCardData(a);for(var i={},n=0;n<a.length;n++){var h=this.getCardColor(a[n]);i.hasOwnProperty(h.toString())||(i[h.toString()]=[]),i[h.toString()].push(a[n])}var d;for(d in i)if(i[d].length>=5){r.push(i[d]);break}return r},e.prototype.findFour=function(t,e){var r=[],a=this.TogetherCardList(t,e);this.SortByCardData(a);for(var i=0;i<a.length;i++)if(i+3<a.length&&this.getCardValue(a[i])==this.getCardValue(a[i+1])&&this.getCardValue(a[i+1])==this.getCardValue(a[i+2])&&this.getCardValue(a[i+2])==this.getCardValue(a[i+3])){var n=[a[i],a[i+1],a[i+2],a[i+3]];r.push(n)}return r},e.prototype.findThree=function(t,e){var r=[],a=this.TogetherCardList(t,e);this.SortByCardData(a);for(var i=0;i<a.length;i++)if(i+2<a.length&&this.getCardValue(a[i])==this.getCardValue(a[i+1])&&this.getCardValue(a[i+1])==this.getCardValue(a[i+2])){var n=[a[i],a[i+1],a[i+2]];r.push(n)}return r},e.prototype.findTwo=function(t,e){var r=[],a=this.TogetherCardList(t,e);this.SortByCardData(a);for(var i=0;i<a.length;i++)if(i+1<a.length&&this.getCardValue(a[i])==this.getCardValue(a[i+1])){var n=[a[i],a[i+1]];r.push(n)}return r},e.prototype.findFullHouse=function(t,e){var r=[],a=this.TogetherCardList(t,e);this.SortByCardData(a);var i=this.findThree(t,e);if(0==i.length)return r;for(var n=0;n<i.length;n++){for(var h=i[n],d=[],s=0;s<a.length;s++)-1==h.indexOf(a[s])&&d.push(a[s]);for(var o=this.findTwo(d,[]),u=0;u<o.length;u++)r.push(h.concat(o[u]))}return r},e.prototype.SortByCardData=function(t){var e=this;t.sort(function(t,r){var a=e.getCardValue(t),i=e.getCardValue(r);return a=1==a?14:a,i=1==i?14:i,a>i?-1:a<i?1:0})},e.prototype.getMaxTwoPair=function(t){for(var e=[],r=0;r<t.length;r++)1==this.getCardValue(t[r][0])?e.push(14):e.push(this.getCardValue(t[r][0]));return t.splice(e.indexOf(Math.min.apply(null,e)),1),t},Object.defineProperty(e,"ins",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e}(r.CardLogic);e.DZPKCardLogic=i});